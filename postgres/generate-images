#!/bin/bash

NAME=PostgreSQL
BASE_REPO=postgres
VARIANTS=(ram postgis postgis-ram)

INCLUDE_ALPINE=true

source ../shared/images/generate.sh


function generate_postgis_ram_variant() {
  printf "#\n# DO NOT MODIFY THIS FILE.  THIS FILE HAS BEEN AUTOGENERATED\n#\n"
  echo 'FROM {{BASE_IMAGE}}-postgis'
  cat resources/Dockerfile-ram.template | grep -v '^FROM'
}

mkdir -p resources
generate_postgis_ram_variant > resources/Dockerfile-postgis-ram.template

# Temporarily removed the PostGIS variant images for PostgreSQL 11 (PG11).
# PostGIS v2.4.4 is failing to compile with PG11 causing the apt package
# potgresql-11-postgis-2.4 to not be available, failing builds. The v2.5.0
# release of PostGIS will fix this, which will also cause a new apt package
# name. We'll need to tackle that issue once PostgreSQL 11 is released.
rm -r ./images/11*/postgis{,-ram}/
